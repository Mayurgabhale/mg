// robust helper: get YYYY-MM-DD for Denver from many possible raw date formats
function extractIsoDate(raw) {
  if (!raw) return '';
  if (typeof raw !== 'string') raw = String(raw);
  // if raw already contains YYYY-MM-DD return that
  const m = raw.match(/(\d{4}-\d{2}-\d{2})/);
  if (m) return m[1];
  // fallback to parsing and convert to Denver date
  try {
    const dt = new Date(raw);
    if (isNaN(dt.getTime())) return '';
    return dt.toLocaleDateString('en-CA', { timeZone: 'America/Denver' });
  } catch (e) {
    return '';
  }
}