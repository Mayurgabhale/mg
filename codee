// selected company from the company table (country||city||company)
const [selectedCompany, setSelectedCompany] = useState(null);

// NEW: selected personnel type coming from the summary table ('Employee'|'Contractor'|null)
const [selectedPersonnel, setSelectedPersonnel] = useState(null);
// NEW: selected summary partition (country||city) from summary table clicks
const [selectedSummaryPartition, setSelectedSummaryPartition] = useState(null);





....




{/* Employee cell (click to filter details to Employees for this partition) */}
<TableCell
  align="right"
  sx={{
    border: '2px solid #000',
    cursor: 'pointer',
    '&:hover': { backgroundColor: '#f2f2f2' },
  }}
  onClick={() => {
    const key = `${row.country}||${row.city}`;
    // toggle: if same selection clicked again, clear it
    if (selectedPersonnel === 'Employee' && selectedSummaryPartition === key) {
      setSelectedPersonnel(null);
      setSelectedSummaryPartition(null);
    } else {
      setSelectedPersonnel('Employee');
      setSelectedSummaryPartition(key);
      // clear company selection when user chooses summary-based filter
      setSelectedCompany(null);
      setShowDetails(true);
    }
  }}
>
  {row.employee}
</TableCell>

{/* Contractors cell (click to filter details to Contractors for this partition) */}
<TableCell
  align="right"
  sx={{
    border: '2px solid #000',
    cursor: 'pointer',
    '&:hover': { backgroundColor: '#f2f2f2' },
  }}
  onClick={() => {
    const key = `${row.country}||${row.city}`;
    if (selectedPersonnel === 'Contractor' && selectedSummaryPartition === key) {
      setSelectedPersonnel(null);
      setSelectedSummaryPartition(null);
    } else {
      setSelectedPersonnel('Contractor');
      setSelectedSummaryPartition(key);
      setSelectedCompany(null);
      setShowDetails(true);
    }
  }}
>
  {row.contractor}
</TableCell>






.....

// --- NEW: if the user clicked a summary cell, filter details to that partition + personnel type ---
    if (selectedSummaryPartition || selectedPersonnel) {
      const [selCountry, selCity] = (selectedSummaryPartition || '').split('||');
      rows = rows.filter(r => {
        let ok = true;
        if (selectedSummaryPartition) {
          ok = ok && r._rowCountry === selCountry && r._rowCity === selCity;
        }
        if (selectedPersonnel) {
          const pt = String(r.PersonnelType || '').toLowerCase();
          if (selectedPersonnel === 'Employee') {
            ok = ok && pt.includes('employee');
          } else if (selectedPersonnel === 'Contractor') {
            ok = ok && pt.includes('contractor');
          }
        }
        return ok;
      });
    }

