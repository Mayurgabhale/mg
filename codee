// NEW: export summary (partitionRows) to Excel -- minimal addition as requested
const handleExportSummary = () => {
  if (!pickedDate) return;
  const rows = partitionRows.map(r => ({
    Country: r.country,
    City: r.city,
    Employees: r.employee,
    Contractors: r.contractor,
    Total: r.total,
  }));

  rows.push({
    Country: 'Total',
    City: '',
    Employees: partitionRows.reduce((s, r) => s + r.employee, 0),
    Contractors: partitionRows.reduce((s, r) => s + r.contractor, 0),
    Total: partitionRows.reduce((s, r) => s + r.total, 0),
  });

  const ws = XLSX.utils.json_to_sheet(rows);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Summary');
  const buf = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
  saveAs(new Blob([buf]), `apac_summary_${format(pickedDate, 'yyyyMMdd')}.xlsx`);
};




....


{/* NEW: Export summary button (minimal addition) */}
<Button
  variant="contained"
  sx={{ ml: 2, bgcolor: '#FFC107', color: '#000' }}
  onClick={handleExportSummary}
>
  Export Summary to Excel
</Button>