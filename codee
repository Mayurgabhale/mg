// src/components/PersonnelSummaryCards.jsx
import React from 'react';
import { Card, Row, Col, Badge } from 'react-bootstrap';
import { FaUserTie, FaHardHat, FaUsers, FaChartPie } from 'react-icons/fa';

const COLORS = ['#FFC72C', '#228B22', '#3A86FF', '#E18E30', '#8338EC', '#FB5607', '#8AC926'];

export default function PersonnelSummaryCards({ data = [] }) {
  const total = data.reduce((sum, e) => sum + e.count, 0);

  if (!data.length || total === 0) {
    return (
      <Card className="mb-4 personnel-summary-card">
        <Card.Header className="personnel-card-header">
          <FaChartPie className="me-2" /> Personnel Type Occupancy
        </Card.Header>
        <Card.Body className="d-flex align-items-center justify-content-center" style={{ minHeight: '200px' }}>
          <div className="text-center text-muted">
            <FaUsers size="2.5rem" className="mb-2" />
            <p>No personnel data available</p>
          </div>
        </Card.Body>
      </Card>
    );
  }

  return (
    <Card className="mb-4 personnel-summary-card">
      <Card.Header className="personnel-card-header">
        <FaChartPie className="me-2" /> Personnel Type Occupancy
      </Card.Header>
      <Card.Body className="personnel-card-body">
        <Row className="g-3">
          {data.map((entry, index) => {
            const percentage = Math.round((entry.count / total) * 100);
            let icon;
            if (entry.personnelType.toLowerCase().includes('employee')) icon = <FaUserTie />;
            else if (entry.personnelType.toLowerCase().includes('contractor')) icon = <FaHardHat />;
            else icon = <FaUsers />;

            return (
              <Col key={entry.personnelType} xs={12} md={6} lg={4} className="mb-2">
                <Card className="personnel-type-card h-100">
                  <Card.Body className="d-flex flex-column justify-content-between p-3">
                    <div className="d-flex justify-content-between align-items-start mb-2">
                      <div className="personnel-icon" style={{ color: COLORS[index % COLORS.length] }}>
                        {icon}
                      </div>
                      <Badge className="percentage-badge" bg="light" text="dark">
                        {percentage}%
                      </Badge>
                    </div>
                    
                    <h6 className="personnel-type-title">{entry.personnelType}</h6>
                    
                    <div className="mt-2">
                      <div className="d-flex justify-content-between align-items-center mb-1">
                        <span className="personnel-count" style={{ color: COLORS[index % COLORS.length] }}>
                          {entry.count}
                        </span>
                        <span className="text-muted small">of {total}</span>
                      </div>
                      <div className="progress" style={{ height: '6px' }}>
                        <div 
                          className="progress-bar" 
                          role="progressbar" 
                          style={{ 
                            width: `${percentage}%`, 
                            backgroundColor: COLORS[index % COLORS.length] 
                          }} 
                          aria-valuenow={percentage} 
                          aria-valuemin="0" 
                          aria-valuemax="100"
                        ></div>
                      </div>
                    </div>
                  </Card.Body>
                </Card>
              </Col>
            );
          })}
        </Row>
      </Card.Body>
      <Card.Footer className="personnel-card-footer">
        <div className="d-flex justify-content-between align-items-center">
          <span className="text-muted">Total Personnel</span>
          <Badge bg="warning" text="dark" className="total-badge">
            {total}
          </Badge>
        </div>
      </Card.Footer>
    </Card>
  );
}