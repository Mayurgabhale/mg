// --- 1) TODAY’S HEADCOUNT (accurate): count everyone whose swipe
// date matches that partition’s current local date (unique by PersonGUID).
const filteredSwipesForToday = swipes.filter(r => {
  const p = r.PartitionName2;
  return getLocalDateString(r.LocaleMessageTime, p) === partitionToday[p];
});

// build unique set per person (across all partitions)
const seen = new Set();
const today = { total: 0, Employee: 0, Contractor: 0 };

filteredSwipesForToday.forEach(r => {
  if (seen.has(r.PersonGUID)) return; // skip duplicates
  seen.add(r.PersonGUID);

  today.total++;
  if (isEmployeeType(r.PersonnelType)) today.Employee++;
  else today.Contractor++;
});